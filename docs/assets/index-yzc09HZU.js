(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))e(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function i(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(l){if(l.ep)return;l.ep=!0;const a=i(l);fetch(l.href,a)}})();const M={development:{apiUrl:"http://localhost:3001/api"},production:{apiUrl:"https://peregian-pickup.vercel.app/api"}},u=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",w=u?"development":"production",P=M[w];class C{constructor(){this.canvas=document.getElementById("gameCanvas"),this.ctx=this.canvas.getContext("2d"),this.gameState="start",this.gameTime=60,this.timeLeft=this.gameTime,this.score=0,this.gameSpeed=1,this.player={x:400,y:300,width:40,height:40,speed:4,vx:0,vy:0,carrying:null,color:"#4A90E2",direction:"down",animFrame:0,animSpeed:.2,immune:!0,immuneTimer:180},this.touches={},this.setupTouchControls(),this.trash=[],this.bins=[],this.enemies=[],this.particles=[],this.obstacles=[],this.soundEffects={},this.initializeSounds(),this.initializeBins(),this.initializeObstacles(),this.spawnTrash(),this.spawnEnemies(),this.apiUrl=P.apiUrl,this.loadLeaderboard(),this.gameLoop(),this.startTimer()}initializeSounds(){this.audioContext=null;try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch{console.log("Audio not supported")}}playSound(t,i,e="sine",l=.1){if(this.audioContext)try{const a=this.audioContext.createOscillator(),s=this.audioContext.createGain();a.connect(s),s.connect(this.audioContext.destination),a.frequency.setValueAtTime(t,this.audioContext.currentTime),a.type=e,s.gain.setValueAtTime(0,this.audioContext.currentTime),s.gain.linearRampToValueAtTime(l,this.audioContext.currentTime+.01),s.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+i),a.start(this.audioContext.currentTime),a.stop(this.audioContext.currentTime+i)}catch{console.log("Sound playback failed")}}playBinSound(t=!0){t?(this.playSound(523,.1,"sine",.15),setTimeout(()=>this.playSound(659,.1,"sine",.15),50),setTimeout(()=>this.playSound(784,.15,"sine",.15),100)):this.playSound(392,.2,"square",.1)}playTurkeySound(){this.playSound(200,.05,"sawtooth",.2),setTimeout(()=>this.playSound(180,.05,"sawtooth",.15),60),setTimeout(()=>this.playSound(220,.05,"sawtooth",.15),120),setTimeout(()=>this.playSound(160,.1,"sawtooth",.1),180)}setupTouchControls(){this.canvas.addEventListener("touchstart",t=>{t.preventDefault();const i=t.touches[0],e=this.canvas.getBoundingClientRect(),l=i.clientX-e.left,a=i.clientY-e.top;if(this.gameState==="start"&&this.checkStartButtonClick(l,a)){this.startGame();return}this.gameState==="playing"&&this.movePlayerTowards(l,a)}),this.canvas.addEventListener("touchmove",t=>{t.preventDefault();const i=t.touches[0],e=this.canvas.getBoundingClientRect(),l=i.clientX-e.left,a=i.clientY-e.top;this.gameState==="playing"&&this.movePlayerTowards(l,a)}),this.canvas.addEventListener("click",t=>{const i=this.canvas.getBoundingClientRect(),e=t.clientX-i.left,l=t.clientY-i.top;if(this.gameState==="start"&&this.checkStartButtonClick(e,l)){this.startGame();return}this.gameState==="playing"&&this.movePlayerTowards(e,l)}),document.addEventListener("keydown",t=>{if(this.gameState==="start"&&(t.key==="Enter"||t.key===" ")){this.startGame();return}this.gameState==="playing"&&this.handleKeyboard(t.key)})}checkStartButtonClick(t,i){return this.startButton?t>=this.startButton.x&&t<=this.startButton.x+this.startButton.width&&i>=this.startButton.y&&i<=this.startButton.y+this.startButton.height:!1}movePlayerTowards(t,i){const e=t-(this.player.x+this.player.width/2),l=i-(this.player.y+this.player.height/2),a=Math.sqrt(e*e+l*l);a>5?(this.player.vx=e/a*this.player.speed,this.player.vy=l/a*this.player.speed):(this.player.vx=0,this.player.vy=0)}handleKeyboard(t){const i=this.player.speed;switch(t){case"ArrowUp":case"w":this.player.vy=-i;break;case"ArrowDown":case"s":this.player.vy=i;break;case"ArrowLeft":case"a":this.player.vx=-i;break;case"ArrowRight":case"d":this.player.vx=i;break}}initializeBins(){this.bins=[{x:50,y:50,width:60,height:80,type:"recycle",color:"#4A90E2",label:"Recycle"},{x:50,y:200,width:60,height:80,type:"compost",color:"#7ED321",label:"Compost"},{x:50,y:350,width:60,height:80,type:"trash",color:"#2D5016",label:"Trash"}]}initializeObstacles(){this.obstacles=[{x:300,y:150,width:80,height:100,type:"slide",color:"#FF6B6B"},{x:500,y:300,width:60,height:60,type:"roundabout",color:"#4ECDC4"},{x:200,y:250,width:50,height:80,type:"tree",color:"#228B22"},{x:600,y:150,width:55,height:85,type:"tree",color:"#32CD32"},{x:450,y:100,width:80,height:30,type:"bench",color:"#8B4513"}]}spawnTrash(){const t=[{type:"recycle",color:"#4A90E2",items:[{name:"bottle",shape:"bottle",color:"#87CEEB",detail:"#4169E1"},{name:"can",shape:"can",color:"#C0C0C0",detail:"#FF6347"},{name:"paper",shape:"paper",color:"#F5F5DC",detail:"#000080"}]},{type:"compost",color:"#7ED321",items:[{name:"banana",shape:"banana",color:"#FFD700",detail:"#8B4513"},{name:"apple",shape:"apple",color:"#FF6347",detail:"#228B22"},{name:"leaves",shape:"leaves",color:"#228B22",detail:"#8B4513"}]},{type:"trash",color:"#2D5016",items:[{name:"wrapper",shape:"wrapper",color:"#FF69B4",detail:"#8A2BE2"},{name:"gum",shape:"gum",color:"#FF1493",detail:"#B22222"},{name:"chip_bag",shape:"bag",color:"#FFD700",detail:"#FF4500"}]}];for(let i=0;i<18;i++){const e=t[Math.floor(Math.random()*t.length)],l=e.items[Math.floor(Math.random()*e.items.length)];let a=0,s=!1,h;for(;!s&&a<30;){h={x:Math.random()*(this.canvas.width-200)+150,y:Math.random()*(this.canvas.height-100)+50,width:24,height:24,type:e.type,item:l.name,shape:l.shape,color:l.color,detailColor:l.detail,rotation:Math.random()*.4-.2},s=!0;for(let o of[...this.obstacles,...this.bins])if(this.isColliding(h,o)){s=!1;break}a++}s&&this.trash.push(h)}}spawnEnemies(){for(let t=0;t<4;t++)this.enemies.push({x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,width:40,height:40,speed:2,chaseSpeed:3.5,color:"#8B4513",chasing:!1,alertDistance:150,aggressionLevel:0,lastPlayerDistance:999,animFrame:Math.random()*4})}updatePlayer(){if(this.player.immune&&(this.player.immuneTimer--,this.player.immuneTimer<=0&&(this.player.immune=!1)),this.player.vx||this.player.vy){const t=this.player.x,i=this.player.y;this.player.x+=this.player.vx,this.player.y+=this.player.vy;let e=!1;for(let l of this.obstacles)if(this.isColliding(this.player,l)){this.player.x=t,this.player.y=i,this.player.vx=0,this.player.vy=0,e=!0;break}if(!e){for(let l of this.bins)if(this.isColliding(this.player,l)){const a=Math.min(this.player.x+this.player.width-l.x,l.x+l.width-this.player.x),s=Math.min(this.player.y+this.player.height-l.y,l.y+l.height-this.player.y);if(a>10&&s>10){this.player.x=t,this.player.y=i,this.player.vx=0,this.player.vy=0,e=!0;break}}}e||(this.player.vx*=.9,this.player.vy*=.9,Math.abs(this.player.vx)<.1&&(this.player.vx=0),Math.abs(this.player.vy)<.1&&(this.player.vy=0))}this.player.x=Math.max(0,Math.min(this.canvas.width-this.player.width,this.player.x)),this.player.y=Math.max(0,Math.min(this.canvas.height-this.player.height,this.player.y))}updateEnemies(){this.enemies.forEach(t=>{t.wanderAngle||(t.wanderAngle=Math.random()*Math.PI*2),t.wanderTimer||(t.wanderTimer=0),t.alertDistance||(t.alertDistance=150),t.aggressionLevel||(t.aggressionLevel=0),t.satisfiedTimer||(t.satisfiedTimer=0),t.satisfiedTimer>0&&(t.satisfiedTimer--,t.aggressionLevel=Math.max(t.aggressionLevel-.05,0));const i=Math.sqrt(Math.pow(this.player.x-t.x,2)+Math.pow(this.player.y-t.y,2));if(this.player.carrying&&!this.player.immune&&t.satisfiedTimer<=0?t.aggressionLevel=Math.min(t.aggressionLevel+.01,.6):t.aggressionLevel=Math.max(t.aggressionLevel-.02,0),this.player.carrying&&!this.player.immune&&i<t.alertDistance&&t.aggressionLevel>.3&&t.satisfiedTimer<=0){t.chasing=!0;const e=this.player.x-t.x,l=this.player.y-t.y;if(Math.sqrt(e*e+l*l)>0){const s=t.chaseSpeed*(.7+t.aggressionLevel*.3),h=this.player.x+(this.player.vx||0)*10,o=this.player.y+(this.player.vy||0)*10,r=h-t.x,n=o-t.y,d=Math.sqrt(r*r+n*n);d>0&&(t.x+=r/d*s,t.y+=n/d*s),t.x+=(Math.random()-.5)*1,t.y+=(Math.random()-.5)*1}Math.random()<.005&&this.playTurkeySound()}else if(!this.player.carrying&&t.chasing&&i<80){t.chasing=!1,t.fleeing=!0,t.fleeTimer=90;const e=t.x-this.player.x,l=t.y-this.player.y,a=Math.sqrt(e*e+l*l);a>0&&(t.x+=e/a*t.speed*2.5,t.y+=l/a*t.speed*2.5)}else if(t.fleeing&&t.fleeTimer>0){t.fleeTimer--;const e=t.x-this.player.x,l=t.y-this.player.y,a=Math.sqrt(e*e+l*l);a>0&&(t.x+=e/a*t.speed*1.5,t.y+=l/a*t.speed*1.5),t.fleeTimer<=0&&(t.fleeing=!1)}else{t.chasing=!1,t.fleeing=!1,t.wanderTimer++,t.wanderTimer>40+Math.random()*80&&(t.wanderAngle=Math.random()*Math.PI*2,t.wanderTimer=0);const e=t.speed*.8;t.x+=Math.cos(t.wanderAngle)*e,t.y+=Math.sin(t.wanderAngle)*e;const l=50;t.x<l&&(t.wanderAngle=Math.random()*Math.PI-Math.PI/2),t.x>this.canvas.width-l&&(t.wanderAngle=Math.random()*Math.PI+Math.PI/2),t.y<l&&(t.wanderAngle=Math.random()*Math.PI),t.y>this.canvas.height-l&&(t.wanderAngle=Math.random()*Math.PI+Math.PI)}for(let e of[...this.obstacles,...this.bins])if(this.isColliding(t,e)){const l=t.x+t.width/2-(e.x+e.width/2),a=t.y+t.height/2-(e.y+e.height/2);t.wanderAngle=Math.atan2(a,l)+(Math.random()-.5)*Math.PI/3;const s=Math.sqrt(l*l+a*a);s>0&&(t.x+=l/s*15,t.y+=a/s*15);break}t.x=Math.max(0,Math.min(this.canvas.width-t.width,t.x)),t.y=Math.max(0,Math.min(this.canvas.height-t.height,t.y)),t.lastPlayerDistance=i})}checkCollisions(){this.player.carrying||this.trash.forEach((t,i)=>{this.isColliding(this.player,t)&&(this.player.carrying=t,this.trash.splice(i,1),this.updateUI(),this.playSound(440,.1,"sine",.1))}),this.player.carrying&&this.bins.forEach(t=>{this.isColliding(this.player,t)&&(this.player.carrying.type===t.type?(this.score+=10,this.createSuccessEffect(t.x+t.width/2,t.y+t.height/2),this.playBinSound(!0)):(this.score+=1,this.createFailEffect(t.x+t.width/2,t.y+t.height/2),this.playBinSound(!1)),this.player.carrying=null,this.updateUI(),Math.random()<.4&&this.spawnNewTrash())}),this.player.carrying&&!this.player.immune&&this.enemies.forEach(t=>{if(this.isColliding(this.player,t)){this.createPeckEffect(this.player.x+this.player.width/2,this.player.y+this.player.height/2),this.playTurkeySound(),this.player.carrying=null,this.updateUI(),this.player.immune=!0,this.player.immuneTimer=90;const i=t.x-this.player.x,e=t.y-this.player.y,l=Math.sqrt(i*i+e*e);l>0&&(t.x+=i/l*40,t.y+=e/l*40),t.aggressionLevel=0,t.chasing=!1,t.satisfiedTimer=180,this.cameraShake=5}})}createSuccessEffect(t,i){for(let e=0;e<15;e++)this.particles.push({x:t,y:i,vx:(Math.random()-.5)*8,vy:(Math.random()-.5)*8-2,life:30,maxLife:30,color:"#00FF00",size:Math.random()*4+2,type:"success"});this.particles.push({x:t,y:i-20,vx:0,vy:-2,life:60,maxLife:60,color:"#00FF00",size:16,type:"scoreText",text:"+10"})}createFailEffect(t,i){for(let e=0;e<8;e++)this.particles.push({x:t,y:i,vx:(Math.random()-.5)*6,vy:(Math.random()-.5)*6,life:20,maxLife:20,color:"#FF6600",size:Math.random()*3+1,type:"fail"});this.particles.push({x:t,y:i-20,vx:0,vy:-1,life:40,maxLife:40,color:"#FF6600",size:14,type:"scoreText",text:"+1"})}createPeckEffect(t,i){for(let e=0;e<15;e++)this.particles.push({x:t,y:i,vx:(Math.random()-.5)*8,vy:(Math.random()-.5)*8,life:30,maxLife:30,color:Math.random()>.5?"#D2691E":"#8B4513",size:Math.random()*4+2,type:"feather"});this.particles.push({x:t,y:i-15,vx:0,vy:-2,life:60,maxLife:60,color:"#F5A623",size:16,type:"scoreText",text:"PECKED!"})}createImpactEffect(t,i){for(let e=0;e<20;e++)this.particles.push({x:t,y:i,vx:(Math.random()-.5)*12,vy:(Math.random()-.5)*12,life:25,maxLife:25,color:"#FF0000",size:Math.random()*5+2,type:"impact"});this.particles.push({x:t,y:i-15,vx:0,vy:-3,life:45,maxLife:45,color:"#FF0000",size:18,type:"scoreText",text:"CAUGHT!"})}updateParticles(){this.particles=this.particles.filter(t=>(t.x+=t.vx,t.y+=t.vy,t.life--,t.type!=="scoreText"&&(t.vy+=.2),t.alpha=t.life/t.maxLife,t.life>0))}spawnNewTrash(){const t=[{type:"recycle",color:"#2196F3",items:["bottle","can","paper"]},{type:"compost",color:"#FF9800",items:["apple","banana","leaves"]},{type:"trash",color:"#F44336",items:["wrapper","gum","broken_toy"]}],i=t[Math.floor(Math.random()*t.length)],e=i.items[Math.floor(Math.random()*i.items.length)];let l=0,a=!1,s;for(;!a&&l<20;){s={x:Math.random()*(this.canvas.width-200)+150,y:Math.random()*(this.canvas.height-100)+50,width:20,height:20,type:i.type,item:e,color:i.color},a=!0;for(let h of[...this.obstacles,...this.bins])if(this.isColliding(s,h)){a=!1;break}l++}a&&this.trash.push(s)}drawPlayer(){const t=this.ctx,i=this.player;let e=0,l=0;this.cameraShake&&this.cameraShake>0&&(e=(Math.random()-.5)*this.cameraShake,l=(Math.random()-.5)*this.cameraShake,this.cameraShake--);const a=i.x+e,s=i.y+l;i.immune&&Math.floor(i.immuneTimer/6)%2===0&&(t.globalAlpha=.5),(i.vx!==0||i.vy!==0)&&(i.animFrame+=i.animSpeed,i.animFrame>=8&&(i.animFrame=0),Math.abs(i.vx)>Math.abs(i.vy)?i.direction=i.vx>0?"right":"left":i.vy!==0&&(i.direction=i.vy>0?"down":"up")),t.fillStyle="rgba(0,0,0,0.3)",t.beginPath(),t.ellipse(a+i.width/2,s+i.height+8,i.width/2+2,10,0,0,Math.PI*2),t.fill(),t.fillStyle="#F5A623";const h=Math.sin(i.animFrame*.5)*3,o=Math.sin(i.animFrame*.8)*2;t.beginPath(),t.moveTo(a-2+o,s+8),t.quadraticCurveTo(a-8+h,s+20,a-1+o,s+32),t.quadraticCurveTo(a+5+h,s+35,a+8+o,s+30),t.quadraticCurveTo(a+6,s+15,a+3,s+8),t.closePath(),t.fill();const r=t.createLinearGradient(a,s,a+i.width,s+25);r.addColorStop(0,"#7ED321"),r.addColorStop(.5,"#4A90E2"),r.addColorStop(1,"#2D5016"),t.fillStyle=r,t.fillRect(a+6,s+14,28,22),t.fillStyle="#2D5016",t.fillRect(a+10,s+18,8,6),t.fillRect(a+22,s+18,8,6),t.fillStyle="#F5A623",t.fillRect(a+8,s+28,24,4),t.fillStyle="#FFDBAC",t.beginPath(),t.arc(a+i.width/2,s+12,14,0,Math.PI*2),t.fill();const n=t.createLinearGradient(a,s,a+i.width,s+15);n.addColorStop(0,"#4A90E2"),n.addColorStop(1,"#2D5016"),t.fillStyle=n,t.beginPath(),t.arc(a+i.width/2,s+9,14,Math.PI,0),t.fill(),t.fillStyle="#7ED321",t.beginPath(),t.arc(a+i.width/2-3,s+6,4,0,Math.PI*2),t.fill(),t.fillStyle="#7ED321",t.font="bold 16px Arial",t.textAlign="center",t.strokeStyle="#2D5016",t.lineWidth=1,t.strokeText("♻",a+i.width/2,s+30),t.fillText("♻",a+i.width/2,s+30),t.fillStyle="#4A90E2";const d=Math.sin(i.animFrame)*1;t.fillRect(a+2,s+16+d,10,14),t.fillStyle="#FFDBAC",t.beginPath(),t.arc(a+7,s+32+d,3,0,Math.PI*2),t.fill(),t.fillStyle="#4A90E2",t.fillRect(a+28,s+16-d,10,14),t.fillStyle="#FFDBAC",t.beginPath(),t.arc(a+33,s+32-d,3,0,Math.PI*2),t.fill();const f=Math.sin(i.animFrame*1.5)*3,c=Math.sin(i.animFrame*1.5+Math.PI)*3;t.fillStyle="#4A90E2",t.fillRect(a+10,s+36,8,12+Math.abs(f)),t.fillRect(a+22,s+36,8,12+Math.abs(c)),t.fillStyle="#2D5016",t.fillRect(a+8,s+46+f,12,6),t.fillRect(a+20,s+46+c,12,6),t.fillStyle="white",t.beginPath(),t.arc(a+16,s+10,3,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(a+24,s+10,3,0,Math.PI*2),t.fill(),t.fillStyle="black",t.beginPath(),t.arc(a+16,s+10,1.5,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(a+24,s+10,1.5,0,Math.PI*2),t.fill(),t.strokeStyle="#8B4513",t.lineWidth=2,t.beginPath(),t.moveTo(a+13,s+6),t.lineTo(a+19,s+7),t.moveTo(a+21,s+7),t.lineTo(a+27,s+6),t.stroke(),i.carrying&&this.drawRealisticTrash(i.carrying,a+15,s-20,.8),t.globalAlpha=1}drawRealisticTrash(t,i,e,l=1){const a=this.ctx,s=t.width*l,h=t.height*l;switch(a.save(),a.translate(i+s/2,e+h/2),a.rotate(t.rotation||0),a.translate(-s/2,-h/2),a.fillStyle="rgba(45, 80, 22, 0.3)",a.fillRect(4,4,s,h),t.shape){case"bottle":this.drawBottle(a,0,0,s,h,t.color,t.detailColor);break;case"can":this.drawCan(a,0,0,s,h,t.color,t.detailColor);break;case"paper":this.drawPaper(a,0,0,s,h,t.color,t.detailColor);break;case"banana":this.drawBanana(a,0,0,s,h,t.color,t.detailColor);break;case"apple":this.drawApple(a,0,0,s,h,t.color,t.detailColor);break;case"leaves":this.drawLeaves(a,0,0,s,h,t.color,t.detailColor);break;case"wrapper":this.drawWrapper(a,0,0,s,h,t.color,t.detailColor);break;case"gum":this.drawGum(a,0,0,s,h,t.color,t.detailColor);break;case"bag":this.drawChipBag(a,0,0,s,h,t.color,t.detailColor);break}a.restore()}drawBottle(t,i,e,l,a,s,h){const o=t.createLinearGradient(i,e,i+l,e+a);o.addColorStop(0,this.lightenColor(s,.3)),o.addColorStop(.5,s),o.addColorStop(1,this.darkenColor(s,.3)),t.fillStyle=o,t.fillRect(i+l*.2,e+a*.3,l*.6,a*.6),t.fillStyle=this.darkenColor(s,.2),t.fillRect(i+l*.35,e,l*.3,a*.4),t.fillStyle=h,t.fillRect(i+l*.3,e,l*.4,a*.15),t.fillStyle="white",t.fillRect(i+l*.25,e+a*.4,l*.5,a*.2),t.fillStyle="rgba(255,255,255,0.6)",t.fillRect(i+l*.25,e+a*.35,l*.15,a*.3)}drawCan(t,i,e,l,a,s,h){const o=t.createRadialGradient(i+l/2,e+a/2,0,i+l/2,e+a/2,l/2);o.addColorStop(0,this.lightenColor(s,.4)),o.addColorStop(.7,s),o.addColorStop(1,this.darkenColor(s,.3)),t.fillStyle=o,t.fillRect(i,e+a*.1,l,a*.8),t.fillStyle=this.darkenColor(s,.4),t.fillRect(i,e,l,a*.15),t.fillRect(i,e+a*.85,l,a*.15),t.fillStyle=h,t.beginPath(),t.arc(i+l*.7,e+a*.1,l*.1,0,Math.PI*2),t.fill(),t.fillStyle=h,t.fillRect(i,e+a*.4,l,a*.2),t.fillStyle="rgba(255,255,255,0.5)",t.fillRect(i+l*.1,e+a*.2,l*.2,a*.6)}drawPaper(t,i,e,l,a,s,h){t.fillStyle=s,t.beginPath(),t.moveTo(i,e),t.lineTo(i+l*.8,e),t.lineTo(i+l,e+a*.2),t.lineTo(i+l,e+a),t.lineTo(i,e+a),t.closePath(),t.fill(),t.fillStyle=this.darkenColor(s,.2),t.beginPath(),t.moveTo(i+l*.8,e),t.lineTo(i+l,e+a*.2),t.lineTo(i+l*.8,e+a*.2),t.closePath(),t.fill(),t.strokeStyle=h,t.lineWidth=1;for(let o=0;o<4;o++)t.beginPath(),t.moveTo(i+l*.1,e+a*.3+o*a*.15),t.lineTo(i+l*.7,e+a*.3+o*a*.15),t.stroke()}drawBanana(t,i,e,l,a,s,h){t.fillStyle=s,t.beginPath(),t.moveTo(i+l*.2,e+a*.8),t.quadraticCurveTo(i+l*.1,e+a*.3,i+l*.4,e+a*.1),t.quadraticCurveTo(i+l*.7,e,i+l*.9,e+a*.2),t.quadraticCurveTo(i+l*.8,e+a*.4,i+l*.6,e+a*.6),t.quadraticCurveTo(i+l*.4,e+a*.9,i+l*.2,e+a*.8),t.fill(),t.fillStyle=h,t.beginPath(),t.arc(i+l*.3,e+a*.4,l*.08,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(i+l*.6,e+a*.3,l*.06,0,Math.PI*2),t.fill(),t.fillStyle=this.lightenColor(s,.3),t.fillRect(i+l*.35,e+a*.2,l*.15,a*.4)}drawApple(t,i,e,l,a,s,h){t.fillStyle=s,t.beginPath(),t.arc(i+l/2,e+a*.6,l*.4,0,Math.PI*2),t.fill(),t.fillStyle=this.darkenColor(s,.3),t.beginPath(),t.arc(i+l/2,e+a*.3,l*.15,0,Math.PI),t.fill(),t.fillStyle=h,t.fillRect(i+l*.48,e+a*.1,l*.04,a*.2),t.fillStyle=h,t.beginPath(),t.ellipse(i+l*.6,e+a*.15,l*.1,l*.05,Math.PI/4,0,Math.PI*2),t.fill(),t.fillStyle=this.lightenColor(s,.4),t.beginPath(),t.arc(i+l*.35,e+a*.45,l*.1,0,Math.PI*2),t.fill()}drawLeaves(t,i,e,l,a,s,h){for(let o=0;o<3;o++){const r=i+o*l*.2,n=e+o*a*.1;t.fillStyle=o===0?s:this.darkenColor(s,.2*o),t.beginPath(),t.ellipse(r+l*.3,n+a*.3,l*.25,a*.4,o*.3,0,Math.PI*2),t.fill(),t.strokeStyle=h,t.lineWidth=1,t.beginPath(),t.moveTo(r+l*.3,n+a*.1),t.lineTo(r+l*.3,n+a*.5),t.stroke()}}drawWrapper(t,i,e,l,a,s,h){t.fillStyle=s,t.beginPath(),t.moveTo(i,e+a*.2),t.lineTo(i+l*.3,e),t.lineTo(i+l*.7,e+a*.1),t.lineTo(i+l,e+a*.3),t.lineTo(i+l*.8,e+a*.7),t.lineTo(i+l*.9,e+a),t.lineTo(i+l*.2,e+a*.9),t.lineTo(i,e+a*.6),t.closePath(),t.fill(),t.fillStyle=this.lightenColor(s,.4),t.fillRect(i+l*.2,e+a*.2,l*.2,a*.15),t.fillRect(i+l*.6,e+a*.5,l*.15,a*.2),t.fillStyle=h,t.fillRect(i+l*.3,e+a*.4,l*.4,a*.1)}drawGum(t,i,e,l,a,s,h){t.fillStyle=s,t.beginPath(),t.arc(i+l*.3,e+a*.4,l*.25,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(i+l*.6,e+a*.6,l*.2,0,Math.PI*2),t.fill(),t.strokeStyle=this.lightenColor(s,.2),t.lineWidth=2,t.beginPath(),t.moveTo(i+l*.5,e+a*.2),t.quadraticCurveTo(i+l*.3,e+a*.1,i+l*.4,e),t.stroke()}drawChipBag(t,i,e,l,a,s,h){const o=t.createLinearGradient(i,e,i+l,e);o.addColorStop(0,this.lightenColor(s,.2)),o.addColorStop(.5,s),o.addColorStop(1,this.darkenColor(s,.2)),t.fillStyle=o,t.beginPath(),t.moveTo(i+l*.1,e),t.lineTo(i+l*.9,e),t.lineTo(i+l*.8,e+a),t.lineTo(i+l*.2,e+a),t.closePath(),t.fill(),t.fillStyle=h,t.fillRect(i+l*.2,e+a*.3,l*.6,a*.4),t.strokeStyle=this.darkenColor(s,.3),t.lineWidth=1;for(let r=0;r<3;r++)t.beginPath(),t.moveTo(i+l*.1,e+a*.2+r*a*.3),t.lineTo(i+l*.9,e+a*.25+r*a*.3),t.stroke()}draw3DTrash(t,i,e,l=1){const a=this.ctx,s=t.width*l,h=t.height*l,o=8*l;a.fillStyle="rgba(0,0,0,0.3)",a.fillRect(i+o/2,e+h+o/2,s,h/2),a.fillStyle=this.lightenColor(t.color,.3),a.beginPath(),a.moveTo(i,e),a.lineTo(i+s,e),a.lineTo(i+s+o,e-o),a.lineTo(i+o,e-o),a.closePath(),a.fill();const r=a.createLinearGradient(i,e,i+s,e+h);r.addColorStop(0,t.color),r.addColorStop(1,this.darkenColor(t.color,.2)),a.fillStyle=r,a.fillRect(i,e,s,h),a.fillStyle=this.darkenColor(t.color,.4),a.beginPath(),a.moveTo(i+s,e),a.lineTo(i+s+o,e-o),a.lineTo(i+s+o,e+h-o),a.lineTo(i+s,e+h),a.closePath(),a.fill(),a.fillStyle="rgba(255,255,255,0.4)",a.fillRect(i+2,e+2,s/3,h/3),a.fillStyle="white",a.font=`bold ${Math.floor(10*l)}px Arial`,a.textAlign="center",a.strokeStyle="black",a.lineWidth=1,a.strokeText(t.item,i+s/2,e+h/2+3),a.fillText(t.item,i+s/2,e+h/2+3),t.type==="recycle"?(a.fillStyle="#00AA00",a.font=`${Math.floor(8*l)}px Arial`,a.fillText("♻",i+s-6,e+10)):t.type==="compost"&&(a.fillStyle="#88AA00",a.font=`${Math.floor(8*l)}px Arial`,a.fillText("🍃",i+s-6,e+10))}lightenColor(t,i){const e=parseInt(t.slice(1),16),l=Math.min(255,Math.floor((e>>16)+(255-(e>>16))*i)),a=Math.min(255,Math.floor((e>>8&255)+(255-(e>>8&255))*i)),s=Math.min(255,Math.floor((e&255)+(255-(e&255))*i));return`rgb(${l},${a},${s})`}drawBin(t){const i=this.ctx,e=i.createLinearGradient(t.x,0,t.x+t.width,0);e.addColorStop(0,t.color),e.addColorStop(.3,t.color),e.addColorStop(.7,this.darkenColor(t.color,.3)),e.addColorStop(1,this.darkenColor(t.color,.5)),i.fillStyle=e,i.fillRect(t.x,t.y,t.width,t.height),i.fillStyle=this.darkenColor(t.color,.2),i.fillRect(t.x-5,t.y-8,t.width+10,10),i.fillStyle="#666",i.fillRect(t.x+t.width/2-3,t.y-12,6,8),i.fillStyle="white",i.font="bold 32px Arial",i.textAlign="center",t.type==="recycle"?i.fillText("♻",t.x+t.width/2,t.y+t.height/2+8):t.type==="compost"?i.fillText("🍎",t.x+t.width/2,t.y+t.height/2+8):i.fillText("🗑",t.x+t.width/2,t.y+t.height/2+8),i.fillStyle="white",i.font="bold 16px Arial",i.fillText(t.label,t.x+t.width/2,t.y-15)}drawObstacle(t){const i=this.ctx,e=15;switch(i.fillStyle="rgba(0,0,0,0.3)",i.fillRect(t.x+e/2,t.y+t.height+e/2,t.width,t.height/3),t.type){case"slide":this.drawSlide(i,t,e);break;case"roundabout":this.drawRoundabout(i,t,e);break;case"seesaw":this.drawSeesaw(i,t,e);break;case"swing":this.drawSwing(i,t,e);break;case"tree":this.drawTree(i,t,e);break;case"bench":this.drawBench(i,t,e);break}}drawSlide(t,i,e){t.fillStyle=this.darkenColor(i.color,.3),t.fillRect(i.x+e,i.y+e,i.width,i.height),t.fillStyle=i.color,t.fillRect(i.x,i.y,i.width,i.height),t.fillStyle=this.darkenColor(i.color,.5),t.beginPath(),t.moveTo(i.x+i.width,i.y),t.lineTo(i.x+i.width+e,i.y+e),t.lineTo(i.x+i.width+e,i.y+i.height+e),t.lineTo(i.x+i.width,i.y+i.height),t.closePath(),t.fill(),t.fillStyle=this.lightenColor(i.color,.2),t.beginPath(),t.moveTo(i.x+10,i.y+10),t.lineTo(i.x+i.width-10,i.y+i.height-10),t.lineTo(i.x+i.width-5,i.y+i.height-10),t.lineTo(i.x+15,i.y+10),t.closePath(),t.fill()}drawRoundabout(t,i,e){const l=i.x+i.width/2,a=i.y+i.height/2,s=i.width/2;t.fillStyle=this.darkenColor(i.color,.5),t.beginPath(),t.arc(l+e/2,a+e/2,s,0,Math.PI*2),t.fill(),t.fillStyle=i.color,t.beginPath(),t.arc(l,a,s,0,Math.PI*2),t.fill(),t.fillStyle=this.darkenColor(i.color,.3),t.beginPath(),t.arc(l,a,s/4,0,Math.PI*2),t.fill(),t.strokeStyle="#666",t.lineWidth=4;for(let h=0;h<4;h++){const o=h*Math.PI/2,r=l+Math.cos(o)*s*.7,n=a+Math.sin(o)*s*.7;t.beginPath(),t.arc(r,n,3,0,Math.PI*2),t.stroke()}}drawSeesaw(t,i,e){const l=i.x+i.width/2,a=i.y+i.height/2;t.fillStyle=this.darkenColor(i.color,.4),t.beginPath(),t.moveTo(l-10,a),t.lineTo(l+10,a),t.lineTo(l,i.y+i.height),t.closePath(),t.fill(),t.fillStyle=i.color,t.fillRect(i.x,i.y,i.width,i.height),t.fillStyle=this.darkenColor(i.color,.3),t.fillRect(i.x+e,i.y+e,i.width,i.height/3),t.fillStyle=this.lightenColor(i.color,.2),t.fillRect(i.x+5,i.y-5,15,10),t.fillRect(i.x+i.width-20,i.y-5,15,10)}drawSwing(t,i,e){t.strokeStyle=i.color,t.lineWidth=6,t.beginPath(),t.moveTo(i.x,i.y+i.height),t.lineTo(i.x+i.width/2,i.y),t.lineTo(i.x+i.width,i.y+i.height),t.stroke(),t.beginPath(),t.moveTo(i.x+5,i.y+10),t.lineTo(i.x+i.width-5,i.y+10),t.stroke(),t.strokeStyle="#666",t.lineWidth=2;const l=i.x+i.width/2;t.beginPath(),t.moveTo(l-3,i.y+10),t.lineTo(l-3,i.y+i.height-10),t.moveTo(l+3,i.y+10),t.lineTo(l+3,i.y+i.height-10),t.stroke(),t.fillStyle="#8B4513",t.fillRect(l-8,i.y+i.height-15,16,6)}drawTree(t,i,e){const l=i.x+i.width/2,a=i.width*.3,s=i.height*.6,h=i.width*.4;t.fillStyle="rgba(0,0,0,0.3)",t.beginPath(),t.arc(l+e/2,i.y+i.height+e/2,h*1.2,0,Math.PI*2),t.fill(),t.fillStyle="#8B4513",t.fillRect(l-a/2,i.y+i.height-s,a,s),t.fillStyle=this.darkenColor("#8B4513",.3),t.fillRect(l-a/2+e/2,i.y+i.height-s+e/2,a/2,s),t.fillStyle=this.darkenColor(i.color,.3),t.beginPath(),t.arc(l+e/3,i.y+h+e/3,h,0,Math.PI*2),t.fill(),t.fillStyle=i.color,t.beginPath(),t.arc(l,i.y+h,h,0,Math.PI*2),t.fill(),t.fillStyle=this.lightenColor(i.color,.3),t.beginPath(),t.arc(l-h/3,i.y+h/2,h/2,0,Math.PI*2),t.fill()}drawBench(t,i,e){t.fillStyle=i.color,t.fillRect(i.x,i.y,i.width,i.height),t.fillStyle=this.darkenColor(i.color,.4),t.beginPath(),t.moveTo(i.x+i.width,i.y),t.lineTo(i.x+i.width+e,i.y+e),t.lineTo(i.x+i.width+e,i.y+i.height+e),t.lineTo(i.x+i.width,i.y+i.height),t.closePath(),t.fill();const l=8,a=i.height+10;t.fillStyle=this.darkenColor(i.color,.2),t.fillRect(i.x+5,i.y+i.height,l,a),t.fillRect(i.x+15,i.y+i.height,l,a),t.fillRect(i.x+i.width-23,i.y+i.height,l,a),t.fillRect(i.x+i.width-13,i.y+i.height,l,a),t.fillStyle=i.color,t.fillRect(i.x,i.y-20,i.width,15)}drawTurkey(t){const i=this.ctx;t.animFrame=(t.animFrame||0)+.2,t.animFrame>=8&&(t.animFrame=0);const e=Math.sin(t.animFrame*2)*(t.chasing?3:1),l=1+(t.aggressionLevel||0)*.2;i.fillStyle="rgba(0,0,0,0.25)",i.beginPath(),i.ellipse(t.x+t.width/2,t.y+t.height+5,t.width/2*l,8,0,0,Math.PI*2),i.fill();let a=t.chasing?"#AA0000":"#8B4513";t.aggressionLevel>.5&&(a=t.chasing?"#FF0000":"#A0522D"),i.fillStyle=a,i.beginPath(),i.ellipse(t.x+t.width/2,t.y+t.height/2+e,18*l,15*l,0,0,Math.PI*2),i.fill();const s=t.chasing?7:5,h=t.chasing?.4:.3;for(let g=0;g<s;g++){const p=(g-s/2)*h,y=t.chasing?20:16,S=t.x+t.width/2-Math.cos(p)*15,T=t.y+t.height/2-Math.sin(p)*10+e,v=["#654321","#8B4513","#A0522D"];i.fillStyle=v[g%3],i.save(),i.translate(S,T),i.rotate(p),i.fillRect(-3,-y/2,6,y),i.fillStyle=t.chasing?"#FF4444":"#D2691E",i.fillRect(-2,-y/2,4,4),i.restore()}i.fillStyle="#A0522D";const o=t.chasing?Math.sin(t.animFrame*4)*3:0;i.save(),i.translate(t.x+8,t.y+12+e),i.rotate(o*.1),i.fillRect(0,0,12,16),i.restore(),i.save(),i.translate(t.x+25,t.y+12+e),i.rotate(-o*.1),i.fillRect(0,0,12,16),i.restore();const r=t.chasing?16:12;i.fillStyle="#D2691E",i.fillRect(t.x+15,t.y+5+e,8,r);const n=t.chasing?8:6;i.fillStyle=a,i.beginPath(),i.arc(t.x+19,t.y+8+e,n,0,Math.PI*2),i.fill(),i.fillStyle="#F5A623",t.chasing?(i.beginPath(),i.moveTo(t.x+26,t.y+6+e),i.lineTo(t.x+32,t.y+4+e),i.lineTo(t.x+30,t.y+8+e),i.fill(),i.beginPath(),i.moveTo(t.x+26,t.y+10+e),i.lineTo(t.x+32,t.y+12+e),i.lineTo(t.x+30,t.y+8+e),i.fill()):(i.beginPath(),i.moveTo(t.x+26,t.y+8+e),i.lineTo(t.x+30,t.y+6+e),i.lineTo(t.x+26,t.y+10+e),i.fill()),i.fillStyle=t.chasing?"#FF0000":"#FF6B6B",i.beginPath(),i.arc(t.x+19,t.y+14+e,t.chasing?4:3,0,Math.PI),i.fill(),i.fillStyle="white",i.beginPath(),i.arc(t.x+21,t.y+6+e,2.5,0,Math.PI*2),i.fill(),i.fillStyle=t.chasing?"#FF0000":"black",i.beginPath(),i.arc(t.x+22,t.y+6+e,t.chasing?2:1,0,Math.PI*2),i.fill(),t.chasing&&(i.strokeStyle="#AA0000",i.lineWidth=2,i.beginPath(),i.moveTo(t.x+18,t.y+3+e),i.lineTo(t.x+24,t.y+5+e),i.stroke()),i.fillStyle="#F5A623";const d=t.chasing?4:2,f=Math.sin(t.animFrame*d)*2,c=Math.sin(t.animFrame*d+Math.PI)*2;if(i.fillRect(t.x+12,t.y+t.height-5+f,4,10),i.fillRect(t.x+22,t.y+t.height-5+c,4,10),i.strokeStyle="#F5A623",i.lineWidth=t.chasing?3:2,i.beginPath(),i.moveTo(t.x+10,t.y+t.height+5+f),i.lineTo(t.x+18,t.y+t.height+5+f),t.chasing&&(i.moveTo(t.x+8,t.y+t.height+3+f),i.lineTo(t.x+10,t.y+t.height+5+f)),i.stroke(),i.beginPath(),i.moveTo(t.x+20,t.y+t.height+5+c),i.lineTo(t.x+28,t.y+t.height+5+c),t.chasing&&(i.moveTo(t.x+28,t.y+t.height+3+c),i.lineTo(t.x+30,t.y+t.height+5+c)),i.stroke(),t.chasing&&Math.random()<.3)for(let g=0;g<3;g++)this.particles.push({x:t.x+t.width/2+(Math.random()-.5)*10,y:t.y+t.height+5,vx:(Math.random()-.5)*2,vy:Math.random()*-2,life:15,maxLife:15,color:"#D2B48C",size:Math.random()*3+1,type:"dust"})}darkenColor(t,i){const e=parseInt(t.slice(1),16),l=Math.floor((e>>16)*(1-i)),a=Math.floor((e>>8&255)*(1-i)),s=Math.floor((e&255)*(1-i));return`rgb(${l},${a},${s})`}lightenColor(t,i){const e=parseInt(t.slice(1),16),l=Math.min(255,Math.floor((e>>16)+(255-(e>>16))*i)),a=Math.min(255,Math.floor((e>>8&255)+(255-(e>>8&255))*i)),s=Math.min(255,Math.floor((e&255)+(255-(e&255))*i));return`rgb(${l},${a},${s})`}isColliding(t,i){return t.x<i.x+i.width&&t.x+t.width>i.x&&t.y<i.y+i.height&&t.y+t.height>i.y}render(){if(this.gameState==="start"){this.renderStartScreen();return}const t=this.ctx.createLinearGradient(0,0,this.canvas.width,this.canvas.height);t.addColorStop(0,"#90EE90"),t.addColorStop(.5,"#7ED321"),t.addColorStop(1,"#5CB85C"),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.drawPlayground(),this.obstacles.forEach(i=>{this.drawObstacle(i)}),this.bins.forEach(i=>{this.drawBin(i)}),this.trash.forEach(i=>{this.drawRealisticTrash(i,i.x,i.y)}),this.enemies.forEach(i=>{this.drawTurkey(i)}),this.drawPlayer(),this.particles.forEach(i=>{this.ctx.save(),this.ctx.globalAlpha=i.alpha||1,i.type==="scoreText"?(this.ctx.fillStyle=i.color,this.ctx.font=`bold ${i.size}px Arial`,this.ctx.textAlign="center",this.ctx.strokeStyle="#2D5016",this.ctx.lineWidth=2,this.ctx.strokeText(i.text,i.x,i.y),this.ctx.fillText(i.text,i.x,i.y)):(this.ctx.fillStyle=i.color,this.ctx.beginPath(),this.ctx.arc(i.x,i.y,i.size,0,Math.PI*2),this.ctx.fill()),this.ctx.restore()})}drawPlayground(){this.ctx.fillStyle="#8B4513",this.ctx.fillRect(600,400,10,100),this.ctx.fillRect(700,400,10,100),this.ctx.fillRect(590,400,130,10),this.ctx.fillStyle="#FFD700",this.ctx.fillRect(500,100,80,20),this.ctx.fillRect(500,120,20,80),this.ctx.fillStyle="#8B4513",this.ctx.fillRect(300,450,15,60),this.ctx.fillRect(750,50,15,80),this.ctx.fillStyle="#228B22",this.ctx.beginPath(),this.ctx.arc(307,440,30,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(757,40,35,0,Math.PI*2),this.ctx.fill()}updateUI(){document.getElementById("score").textContent=this.score,document.getElementById("carrying").textContent=this.player.carrying?this.player.carrying.item:"Nothing"}startTimer(){this.timerInterval=setInterval(()=>{this.timeLeft--,document.getElementById("timer").textContent=this.timeLeft,this.timeLeft<=0&&this.endGame()},1e3)}endGame(){this.gameState="gameOver",clearInterval(this.timerInterval),document.getElementById("finalScore").textContent=this.score,document.getElementById("gameOver").style.display="block"}async submitScore(){const t=document.getElementById("playerName").value.trim()||"Anonymous";try{const i=await fetch(`${this.apiUrl}/scores`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({player_name:t,score:this.score})});if(i.ok){const e=await i.json();console.log("Score submitted successfully:",e),this.loadLeaderboard(),this.showMessage("Score saved!","#7ED321")}else throw new Error("Failed to submit score")}catch(i){console.error("Error submitting score:",i),this.submitScoreOffline(t),this.showMessage("Score saved locally (offline)","#F5A623")}}submitScoreOffline(t){const i=this.getStoredScores();i.push({name:t,score:this.score,date:new Date().toLocaleDateString()}),i.sort((e,l)=>l.score-e.score),i.splice(10),localStorage.setItem("recycleGameScores",JSON.stringify(i)),this.displayLeaderboardOffline()}async loadLeaderboard(){try{const t=await fetch(`${this.apiUrl}/scores`);if(t.ok){const i=await t.json();this.displayLeaderboard(i)}else throw new Error("Failed to load leaderboard")}catch(t){console.error("Error loading leaderboard:",t),this.displayLeaderboardOffline()}}getStoredScores(){const t=localStorage.getItem("recycleGameScores");return t?JSON.parse(t):[]}displayLeaderboard(t){const i=document.getElementById("scores");t&&t.length>0?i.innerHTML=t.slice(0,5).map((e,l)=>`${l+1}. ${e.player_name}: ${e.score}`).join("<br>"):i.innerHTML="No scores yet!"}displayLeaderboardOffline(){const t=this.getStoredScores(),i=document.getElementById("scores");i.innerHTML=t.slice(0,5).map((e,l)=>`${l+1}. ${e.name}: ${e.score} (offline)`).join("<br>")}showMessage(t,i="#FFFFFF"){const e=document.createElement("div");e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.background="rgba(0,0,0,0.8)",e.style.color=i,e.style.padding="20px",e.style.borderRadius="10px",e.style.fontSize="18px",e.style.fontWeight="bold",e.style.zIndex="1000",e.style.animation="fadeInOut 2s ease-in-out",e.textContent=t;const l=document.createElement("style");l.textContent=`
      @keyframes fadeInOut {
        0%, 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        50% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
      }
    `,document.head.appendChild(l),document.body.appendChild(e),setTimeout(()=>{document.body.removeChild(e),document.head.removeChild(l)},2e3)}restart(){this.gameState="start",this.timeLeft=this.gameTime,this.score=0,this.player.x=400,this.player.y=300,this.player.carrying=null,this.player.vx=0,this.player.vy=0,this.trash=[],this.enemies=[],document.getElementById("gameOver").style.display="none",document.getElementById("playerName").value="",this.updateUI()}renderStartScreen(){this.ctx.fillStyle="#22C55E",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#1F7A1F";for(let o=0;o<8;o++){const r=Math.random()*this.canvas.width,n=Math.random()*this.canvas.height;this.ctx.beginPath(),this.ctx.arc(r,n,3,0,Math.PI*2),this.ctx.fill()}[{type:"can",x:700,y:150},{type:"bottle",x:150,y:450},{type:"apple",x:650,y:500}].forEach(o=>{this.drawRealisticTrash(o,o.x,o.y,.7)}),this.ctx.save(),this.ctx.fillStyle="#F5A623",this.ctx.strokeStyle="#B8860B",this.ctx.lineWidth=3,this.ctx.font="bold 48px Arial",this.ctx.textAlign="center",this.ctx.translate(this.canvas.width/2,120),this.ctx.rotate(-.05),this.ctx.fillText("Peregian Pickup",0,0),this.ctx.strokeText("Peregian Pickup",0,0),this.ctx.restore(),this.ctx.fillStyle="#2D4A22",this.ctx.font="bold 20px Arial",this.ctx.textAlign="left";const i=["• Sort as much rubbish as you can","  before time runs out!","","• Don't let the bush turkeys take","  rubbish off you!","","• Drag to move",'• Push "START" to begin'];let e=220;i.forEach(o=>{this.ctx.fillText(o,80,e),e+=28});const l=this.canvas.width/2-100,a=450,s=200,h=80;this.ctx.fillStyle="rgba(0, 0, 0, 0.3)",this.ctx.fillRect(l+5,a+5,s,h),this.ctx.fillStyle="#F5A623",this.ctx.fillRect(l,a,s,h),this.ctx.strokeStyle="#B8860B",this.ctx.lineWidth=4,this.ctx.strokeRect(l,a,s,h),this.ctx.fillStyle="white",this.ctx.font="bold 36px Arial",this.ctx.textAlign="center",this.ctx.fillText("START",this.canvas.width/2,a+50),this.startButton={x:l,y:a,width:s,height:h}}startGame(){this.gameState="playing",this.timeLeft=this.gameTime,this.score=0,this.player.x=400,this.player.y=300,this.player.carrying=null,this.player.vx=0,this.player.vy=0,this.player.immune=!0,this.player.immuneTimer=180,this.trash=[],this.enemies=[],this.spawnTrash(),this.spawnEnemies(),this.updateUI(),this.startTimer()}gameLoop(){this.gameState==="playing"&&(this.updatePlayer(),this.updateEnemies(),this.updateParticles(),this.checkCollisions()),this.render(),requestAnimationFrame(()=>this.gameLoop())}}window.addEventListener("load",()=>{window.game=new C});
